import{g as kt,c as Kt}from"./commonjsHelpers.Cpj98o6Y.js";import{d as Dt,ag as pt,s as mt,h as Ot,v as Ct,ar as At,as as Pt,at as Ft,y as Ht,z as Lt,au as Ut}from"./framework.CoCT1vi4.js";var Rt={exports:{}};/*!
 * sortable-dnd v0.7.1
 * open source under the MIT license
 * https://github.com/mfuu/sortable-dnd#readme
 */(function(g,o){(function(n,s){g.exports=s()})(Kt,function(){function n(){return n=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)({}).hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},n.apply(null,arguments)}function s(t){return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(t)}var f={capture:!1,passive:!1},b=/\s+/g;function T(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var D=T(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),X=T(/Edge/i),O=T(/safari/i)&&!T(/chrome/i)&&!T(/android/i),G=function(){var t=!1;return document.addEventListener("checkIfSupportPassive",null,{get passive(){return t=!0,!0}}),t}();function B(t,e,i){window.addEventListener?t.addEventListener(e,i,!(!G&&D)&&f):window.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i}function N(t,e,i){window.removeEventListener?t.removeEventListener(e,i,!(!G&&D)&&f):window.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=null}function ut(){return document.scrollingElement||document.documentElement}function K(t,e,i){if(t.getBoundingClientRect||t===window){var r,l,a,d,u,m,M;if(t!==window&&t.parentNode&&t!==ut()?(l=(r=t.getBoundingClientRect()).top,a=r.left,d=r.bottom,u=r.right,m=r.height,M=r.width):(l=0,a=0,d=window.innerHeight,u=window.innerWidth,m=window.innerHeight,M=window.innerWidth),e&&t!==window){i=i||t.parentNode;do if(i&&i.getBoundingClientRect){var E=i.getBoundingClientRect();l-=E.top+parseInt(w(i,"border-top-width")),a-=E.left+parseInt(w(i,"border-left-width")),d=l+r.height,u=a+r.width;break}while(i=i.parentNode)}return{top:l,left:a,bottom:d,right:u,width:M,height:m}}}function J(t,e,i,r){if(t){i=i||document;do{if(e!=null&&(e[0]===">"?t.parentNode===i&&rt(t,e):rt(t,e))||r&&t===i)return t;if(t===i)break}while(t=t.parentNode);return null}}function ht(t,e){if(!t||!e)return!1;if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(t));if(e.contains&&t.nodeType===1)return e.contains(t)&&e!==t;for(;t=t.parentNode;)if(t===e)return!0;return!1}function vt(t,e){for(var i=t.lastElementChild;i&&(i===C.ghost||w(i,"display")==="none"||e);)i=i.previousElementSibling;return i||null}function Q(t,e){if(!t||!t.parentNode)return-1;for(var i=0;t=t.previousElementSibling;)t===C.ghost||t.nodeName.toUpperCase()==="TEMPLATE"||w(t,"display")==="none"||e&&!rt(t,e)||i++;return i}function nt(t,e,i,r){for(var l=0,a=0,d=t.children;l<d.length;){if(d[l]!==C.ghost&&w(d[l],"display")!=="none"&&J(d[l],i,t,!1)&&d[l]!==C.dragged){if(a===e)return d[l];a++}l++}return null}function gt(t,e){var i=w(t),r=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),l=nt(t,0,e),a=nt(t,1,e),d=l&&w(l),u=a&&w(a),m=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+K(l).width,M=u&&parseInt(u.marginLeft)+parseInt(u.marginRight)+K(a).width,E=X||D?"cssFloat":"float";if(i.display==="flex")return i.flexDirection==="column"||i.flexDirection==="column-reverse"?"vertical":"horizontal";if(i.display==="grid")return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(l&&d.float&&d.float!=="none"){var z=d.float==="left"?"left":"right";return!a||u.clear!=="both"&&u.clear!==z?"horizontal":"vertical"}return l&&(d.display==="block"||d.display==="flex"||d.display==="table"||d.display==="grid"||m>=r&&i[E]==="none"||a&&i[E]==="none"&&m+M>r)?"vertical":"horizontal"}function F(t,e,i){if(t&&e)if(t.classList)t.classList[i?"add":"remove"](e);else{var r=(" "+t.className+" ").replace(b," ").replace(" "+e+" "," ");t.className=(r+(i?" "+e:"")).replace(b," ")}}function rt(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function w(t,e,i){var r=t&&t.style;if(r){if(i===void 0)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(i=t.currentStyle),e===void 0?i:i[e];e in r||e.indexOf("webkit")!==-1||(e="-webkit-"+e),r[e]=i+(typeof i=="string"?"":"px")}}function St(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}function S(t,e){var i,r,l=(r=e,(i=t).compareDocumentPosition?i.compareDocumentPosition(r):i.contains?(i!=r&&i.contains(r)&&16)+(i!=r&&r.contains(i)&&8)+(i.sourceIndex>=0&&r.sourceIndex>=0?(i.sourceIndex<r.sourceIndex&&4)+(i.sourceIndex>r.sourceIndex&&2):1):0);return l===2?1:l===4?-1:0}function st(t){t.preventDefault!==void 0&&t.cancelable&&t.preventDefault()}function L(t){var e=t.sortable,i=t.name,r=t.evt,l=e.options[i];if(typeof l=="function")return l(n({},r))}function lt(t){if(typeof t=="function"){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return t.apply(void 0,i)}return t}var U="Sortable"+Date.now();function yt(t){this.options=t,this.scrollEl=null,this.autoScrollInterval=null}function bt(t){this.options=t,this.animationStack=[],this.animationCallbackId=null}function wt(t,e){return Math.sqrt(Math.pow(t.left-e.left,2)+Math.pow(t.top-e.top,2))}yt.prototype={nulling:function(){this.autoScrollInterval&&(clearInterval(this.autoScrollInterval),this.autoScrollInterval=null)},onStarted:function(){this.nulling(),this.autoScrollInterval=setInterval(this.autoScroll.bind(this))},onMove:function(t,e,i,r){var l=i?i[U].options:r;!i||l.autoScroll?(this.options=l,this.scrollEl=function(a,d){if(!a||!a.getBoundingClientRect)return ut();var u=a;do if(u.clientWidth<u.scrollWidth||u.clientHeight<u.scrollHeight){var m=w(u);if(u.clientWidth<u.scrollWidth&&(m.overflowX=="auto"||m.overflowX=="scroll")||u.clientHeight<u.scrollHeight&&(m.overflowY=="auto"||m.overflowY=="scroll"))return!u.getBoundingClientRect||u===document.body?ut():u}while(u=u.parentNode);return ut()}(t),this.moveEvent=e):this.scrollEl=null},autoScroll:function(){var t=this.options,e=this.moveEvent,i=this.scrollEl,r=t.scrollThreshold,l=t.scrollSpeed;if(i&&e.clientX!==void 0&&e.clientY!==void 0){var a=K(i);if(a){var d=e.clientX,u=e.clientY,m=a.top,M=a.right,E=a.bottom,z=a.left,_=a.height,q=a.width;if(!(u<m||d>M||u>E||d<z)){var it=i.scrollTop,k=i.scrollLeft,ct=i.scrollHeight,ft=i.scrollWidth;i.scrollLeft+=this.getScrollOffset(d,z,M,r,l.x,k,ft,q),i.scrollTop+=this.getScrollOffset(u,m,E,r,l.y,it,ct,_)}}}},getScrollOffset:function(t,e,i,r,l,a,d,u){return a>0&&t>=e&&t<=e+r?Math.max(-1,(t-e)/r-1)*l:a+u<d&&t<=i&&t>=i-r?Math.min(1,(t-i)/r+1)*l:0}},bt.prototype={collect:function(t){if(t){for(var e=K(t),i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=Math.min(e.right,i),a=Math.min(e.bottom,r),d=Array.prototype.slice.call(t.children),u=[],m=0,M=d.length;m<M;m++){var E=d[m];if(E!==C.ghost&&w(E,"display")!=="none"){var z=K(E);if(!(z.bottom<0||z.right<0)){if(u.length===0&&E.previousElementSibling){var _=E.previousElementSibling;do if(_&&_!==C.ghost&&w(_,"display")!=="none")break;while(_=_.previousElementSibling);_&&u.push({el:_,rect:K(_)})}if(z.top-z.height>a||z.left-z.width>l){u.push({el:E,rect:z});break}u.push({el:E,rect:z})}}}this.animationStack.push(u)}},animate:function(t){var e=this,i=this.animationStack.pop(),r=this.options.animation;if(!i||!r)return clearTimeout(this.animationCallbackId),void(typeof t=="function"&&t());var l=0;i.forEach(function(a){var d=0,u=a.el,m=K(u),M=a.rect,E=u.prevToRect,z=u.prevFromRect;if(u.animating&&z&&E&&St(M,m)){var _=function(q,it){var k="";if(typeof q=="string")k=q;else do{var ct=w(q,"transform");ct&&ct!=="none"&&(k=ct+" "+k)}while(!1);var ft=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return ft&&new ft(k)}(u);_&&(d=wt({top:m.top-_.f,left:m.left-_.e},m)/wt(z,E)*r)}St(M,m)||(u.prevFromRect=M,u.prevToRect=m,d||(d=r),e.execute(u,M,m,d)),d&&(l=Math.max(l,d))}),clearTimeout(this.animationCallbackId),l?this.animationCallbackId=setTimeout(function(){typeof t=="function"&&t()},l):typeof t=="function"&&t()},execute:function(t,e,i,r){var l=this.options.easing||"",a=e.left-i.left,d=e.top-i.top;w(t,"transition",""),w(t,"transform","translate3d(".concat(a,"px, ").concat(d,"px, 0)")),this.repaintDummy=function(u){return u.offsetWidth}(t),w(t,"transition","transform ".concat(r,"ms ").concat(l)),w(t,"transform","translate3d(0px, 0px, 0px)"),typeof t.animating=="number"&&clearTimeout(t.animating),t.animating=setTimeout(function(){w(t,"transition",""),w(t,"transform",""),t.prevFromRect=null,t.prevToRect=null,t.animating=null},r)}};var Z,R,v,y,h,p,c,I,A,x,Y,P,tt,V,H,j,et,W,ot,at,dt,xt=[];function _t(t){var e,i,r,l={},a=t.group;a&&s(a)==="object"||(a={name:a,pull:!0,put:!0,revertDrag:!0}),l.name=a.name,l.pull=(e=a.pull)===null||e===void 0||e,l.put=(i=a.put)===null||i===void 0||i,l.revertDrag=(r=a.revertDrag)===null||r===void 0||r,t.group=l}function C(t,e){if(!t||!t.nodeType||t.nodeType!==1)throw"Sortable-dnd: `el` must be an HTMLElement, not ".concat({}.toString.call(t));t[U]=this,this.el=t,this.options=e=n({},e);var i={store:null,group:"",handle:null,draggable:">*",sortable:!0,disabled:!1,customGhost:null,lockAxis:"",direction:"",animation:150,easing:"",chosenClass:"",placeholderClass:"",ghostClass:"",ghostStyle:{},ghostContainer:null,appendToBody:!1,autoScroll:!0,scrollThreshold:55,scrollSpeed:{x:10,y:10},delay:0,delayOnTouchOnly:!1,swapOnDrop:!0,removeCloneOnDrop:!0,dropOnAnimationEnd:!1,supportTouch:"ontouchstart"in window,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,emptyInsertThreshold:-1};for(var r in i)!(r in e)&&(e[r]=i[r]);for(var l in _t(e),this)l.charAt(0)==="_"&&typeof this[l]=="function"&&(this[l]=this[l].bind(this));B(t,e.supportTouch?"touchstart":"mousedown",this._onDrag),this.autoScroller=new yt(e),this.animator=new bt(e),xt.push(t)}return C.prototype={constructor:C,_onDrag:function(t){var e=this,i=this.el,r=this.options,l=r.handle,a=t.touches&&t.touches[0],d=(a||t).target,u=i.ownerDocument;if(!v&&!r.disabled&&r.group.pull&&!(/mousedown|pointerdown/.test(t.type)&&t.button!==0||O&&d&&d.tagName.toUpperCase()==="SELECT")){var m=J(d,r.draggable,i);m&&!m.animating&&(H={event:t,clientX:(a||t).clientX,clientY:(a||t).clientY},v=m,B(W=a?v:document,"mouseup",this._onDrop),B(W,"touchend",this._onDrop),B(W,"touchcancel",this._onDrop),typeof l=="function"&&!l(t)||typeof l=="string"&&!J(d,l,v)||(!r.delay||r.delayOnTouchOnly&&!a||X||D?this._onStart(a,t):(B(u,"touchmove",this._delayedMoveHandler),B(u,"mousemove",this._delayedMoveHandler),B(u,"mouseup",this._cancelStart),B(u,"touchend",this._cancelStart),B(u,"touchcancel",this._cancelStart),this._dragStartTimer=setTimeout(function(){return e._onStart(a,t)},r.delay))))}},_delayedMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-H.clientX),Math.abs(e.clientY-H.clientY))>=Math.floor(this.options.touchStartThreshold/(window.devicePixelRatio||1))&&this._cancelStart()},_cancelStart:function(){var t=this.el.ownerDocument;clearTimeout(this._dragStartTimer),N(t,"touchmove",this._delayedMoveHandler),N(t,"mousemove",this._delayedMoveHandler),N(t,"mouseup",this._cancelStart),N(t,"touchend",this._cancelStart),N(t,"touchcancel",this._cancelStart)},_onStart:function(t,e){st(e);var i=this.el,r=this.options,l=Q(v);P=l,tt=l,V=l,Z=i,R=i,p=i,A=v,x=v.parentNode,Y=r.group.pull,at=v,ot={to:i,target:v,newIndex:l,relative:0},c=v.cloneNode(!0),C.dragged=v,C.clone=c,C.active=this,L({sortable:this,name:"onChoose",evt:this._getEventProperties(e)}),F(v,r.chosenClass,!0),B(W,t?"touchmove":"mousemove",this._nearestSortable);try{document.selection?setTimeout(function(){return document.selection.empty()},0):window.getSelection().removeAllRanges()}catch{}B(document,"selectstart",st),O&&w(document.body,"user-select","none")},_onStarted:function(){var t=this.options;this.animator.collect(x),this._appendGhost(),F(c,t.chosenClass,!0),F(c,t.placeholderClass,!0),v.parentNode.insertBefore(c,v),w(v,"display","none"),L({sortable:this,name:"onDrag",evt:this._getEventProperties(H.event)}),this.animator.animate(),this.autoScroller.onStarted()},_appendGhost:function(){if(!I){var t=this.options,e=t.appendToBody?document.body:lt(t.ghostContainer,this)||this.el,i=lt(t.customGhost,c)||c;F(I=i.cloneNode(!0),t.ghostClass,!0);var r=K(v),l=n({position:"fixed",top:r.top,left:r.left,width:r.width,height:r.height,margin:0,zIndex:1e5,opacity:"0.8",overflow:"hidden",boxSizing:"border-box",transform:"",transition:"",pointerEvents:"none"},t.ghostStyle);for(var a in l)w(I,a,l[a]);C.ghost=I,e.appendChild(I);var d=(H.clientX-r.left)/parseInt(I.style.width)*100,u=(H.clientY-r.top)/parseInt(I.style.height)*100;w(I,"transform-origin","".concat(d,"% ").concat(u,"%")),w(I,"will-change","transform")}},_nearestSortable:function(t){st(t);var e=t.touches&&t.touches[0]||t;if(v&&function(_){var q=j||H;return!(_.clientX!==void 0&&_.clientY!==void 0&&Math.abs(_.clientX-q.clientX)<=0&&Math.abs(_.clientY-q.clientY)<=0)}(e)){!j&&this._onStarted();var i=this.options.lockAxis,r=i==="x"?H.clientX:e.clientX,l=i==="y"?H.clientY:e.clientY,a=document.elementFromPoint(r,l),d=r-H.clientX,u=l-H.clientY;j={event:t,clientX:r,clientY:l},w(I,"transform","translate3d(".concat(d,"px, ").concat(u,"px, 0)"));var m,M,E,z=(m=r,M=l,xt.reduce(function(_,q){var it=q[U].options.emptyInsertThreshold;if(it!=null){var k=K(q),ct=m>=k.left-it&&m<=k.right+it,ft=M>=k.top-it&&M<=k.bottom+it;return ct&&ft&&(!E||E&&k.left>=E.left&&k.right<=E.right&&k.top>=E.top&&k.bottom<=E.bottom)&&(_=q,E=k),_}},null));z&&z[U]._onMove(t,a),this.autoScroller.onMove(a,j,z,this.options)}},_allowPut:function(){var t=this.options.group,e=p[U].options.group;return this.el===p||!!t.put&&(t.put.join&&t.put.indexOf(e.name)>-1||e.name&&t.name&&e.name===t.name)},_getDirection:function(){var t=this.options.draggable,e=this.options.direction;return e?lt(e,j.event,c,this):gt(x,t)},_allowSwap:function(){var t=K(y),e=this._getDirection()==="vertical",i=e?"top":"left",r=e?"bottom":"right",l=y[e?"offsetHeight":"offsetWidth"],a=e?j.clientY:j.clientX,d=a>=t[i]&&a<t[r]-l/2?-1:1,u=nt(x,0,this.options.draggable),m=vt(x),M=K(u),E=K(m);if(y===x||ht(x,y))return c===u&&a<M[i]?(h=y,!0):c===m&&a>E[r]&&(h=y.nextSibling,!0);var z=S(c,y);return h=z<0?y.nextSibling:y,et!==y?(dt=d,!0):dt!==d&&(dt=d,d<0?z>0:z<0)},_onMove:function(t,e){var i=this.el,r=this.options;if(!r.disabled&&this._allowPut()){if(y=J(e,r.draggable,i),L({sortable:this,name:"onMove",evt:this._getEventProperties(t,{target:y})}),r.sortable||i!==p)return i===R||e!==i&&vt(i)?void(y&&!y.animating&&!ht(y,c)&&this._allowSwap()&&(y!==c&&h!==c&&(i!==R?this._onInsert(t):y!==v&&this._onChange(t)),et=y)):(y=et=null,void this._onInsert(t));R!==p&&(y=et=v,dt=0,this._onInsert(t))}},_onInsert:function(t){var e=this.el,i=y||c,r=Y==="clone"&&e!==p&&R===p,l=Y==="clone"&&e===p&&R!==p,a=ht(y,document),d=y===v&&!a,u=R[U],m=p[U];Z=e,P=Q(c),A=i,x=a?y.parentNode:e,u.animator.collect(c.parentNode),this.animator.collect(x),r&&(ot.target=at,ot.newIndex=P,ot.relative=at===v?0:S(c,at),w(v,"display",""),m.options.group.revertDrag||c.parentNode.insertBefore(v,c)),l&&(P=Q(v),w(v,"display","none")),w(c,"display",d?"none":""),y&&a?x.insertBefore(c,dt<0?y:y.nextSibling):x.appendChild(c),tt=d?V:Q(c),r&&m.options.group.revertDrag&&(ot.target=v,ot.newIndex=V,ot.relative=0,L({sortable:m,name:"onChange",evt:this._getEventProperties(t,{to:p,target:v,newIndex:V,revertDrag:!0})})),r||L({sortable:u,name:"onRemove",evt:this._getEventProperties(t,{newIndex:-1})}),l&&i!==v&&(at=i,L({sortable:this,name:"onChange",evt:this._getEventProperties(t,{from:p,backToOrigin:!0})})),l||L({sortable:this,name:"onAdd",evt:this._getEventProperties(t,{oldIndex:-1})}),u.animator.animate(),this.animator.animate(),R=e},_onChange:function(t){var e=this.el;this.animator.collect(x),P=Q(c),x=y.parentNode,A=y,e===p&&(at=y),x.insertBefore(c,h),tt=Q(c),L({sortable:this,name:"onChange",evt:this._getEventProperties(t)}),this.animator.animate(),R=e},_onDrop:function(t){var e=this,i=this.options;if(this._cancelStart(),N(W,"touchmove",this._nearestSortable),N(W,"mousemove",this._nearestSortable),N(W,"mouseup",this._onDrop),N(W,"touchend",this._onDrop),N(W,"touchcancel",this._onDrop),N(document,"selectstart",st),O&&w(document.body,"user-select",""),I&&I.parentNode&&I.parentNode.removeChild(I),p)if(R=p,P=V,A===c&&(A=v),F(v,i.chosenClass,!1),L({sortable:this,name:"onUnchoose",evt:this._getEventProperties(t)}),j){this.animator.collect(x),F(c,i.chosenClass,!1),F(c,i.placeholderClass,!1);var r=this._getEventProperties(t);!i.dropOnAnimationEnd&&this._onEnd(r),this.animator.animate(function(){i.dropOnAnimationEnd&&e._onEnd(r)})}else this._nulling();else this._nulling()},_onEnd:function(t){var e=this.options,i=Y==="clone",r=R===Z;i&&!r||!lt(e.swapOnDrop,t)||x.insertBefore(v,c),i&&!r||!lt(e.removeCloneOnDrop,t)||c&&c.parentNode&&c.parentNode.removeChild(c),w(v,"display",""),R!==Z&&L({sortable:R[U],name:"onDrop",evt:n({},t,i?ot:{newIndex:-1})}),L({sortable:Z[U],name:"onDrop",evt:n({},t,r?{}:{oldIndex:-1})}),this._nulling()},_getEventProperties:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i={};return i.event=t,i.to=Z,i.from=R,i.node=v,i.clone=c,i.target=A,i.oldIndex=P,i.newIndex=tt,i.pullMode=Y,n(i,e),i.relative=A===v?0:S(c,A),i},_nulling:function(){Z=R=v=y=h=p=c=I=A=x=Y=P=tt=V=H=j=et=W=ot=at=dt=C.clone=C.ghost=C.active=C.dragged=null,this.autoScroller.nulling()},destroy:function(){this._cancelStart(),this._nulling(),N(this.el,"touchstart",this._onDrag),N(this.el,"mousedown",this._onDrag);var t=xt.indexOf(this.el);t>-1&&xt.splice(t,1),this.el[U]=this.animator=this.autoScroller=null},option:function(t,e){if(e===void 0)return this.options[t];this.options[t]=e,this.animator.options[t]=e,this.autoScroller.options[t]=e,t==="group"&&_t(this.options)}},C.utils={on:B,off:N,css:w,index:Q,matches:rt,closest:J,getRect:K,toggleClass:F,detectDirection:gt},C.get=function(t){return t[U]},C.create=function(t,e){return new C(t,e)},C})})(Rt);var Wt=Rt.exports;const $=kt(Wt);function Tt(g,o){let n;const s=function(...f){n||(o<=0?g.apply(this,f):n=setTimeout(()=>{n=null,g.apply(this,f)},o))};return s.cancel=function(){n&&(clearTimeout(n),n=null)},s}function Yt(g,o){const n=Tt(g,o),s=function(...f){n.cancel(),n.apply(this,f)};return s.cancel=function(){n.cancel()},s}function Et(g,o){return g===0&&o===0?1/g===1/o:Number.isNaN(g)&&Number.isNaN(o)?!0:g==o}function Mt(g,o){return(Array.isArray(o)?o:o.replace(/\[/g,".").replace(/\]/g,".").split(".")).reduce((n,s)=>(n||{})[s],g)}function Bt(g){return g instanceof Document&&g.nodeType===9||g instanceof Window}class qt{constructor(o){this.options=o;const n={size:0,keeps:0,buffer:0,wrapper:null,scroller:null,direction:"vertical",uniqueKeys:[],debounceTime:null,throttleTime:null};for(const s in n)!(s in this.options)&&(this.options[s]=n[s]);this.sizes=new Map,this.sizeType="INIT",this.fixedSize=0,this.averageSize=0,this.range={start:0,end:0,front:0,behind:0},this.offset=0,this.direction="STATIONARY",this.updateScrollElement(),this.updateOnScrollFunction(),this.addScrollEventListener(),this.checkIfUpdate(0,o.keeps-1)}isFixed(){return this.sizeType==="FIXED"}isFront(){return this.direction==="FRONT"}isBehind(){return this.direction==="BEHIND"}isHorizontal(){return this.options.direction==="horizontal"}getSize(o){return this.sizes.get(o)||this.getItemSize()}getOffset(){const o=this.isHorizontal()?"scrollLeft":"scrollTop";return this.scrollEl[o]}getScrollSize(){const o=this.isHorizontal()?"scrollWidth":"scrollHeight";return this.scrollEl[o]}getClientSize(){const o=this.isHorizontal()?"offsetWidth":"offsetHeight";return this.scrollEl[o]}scrollToOffset(o){const n=this.isHorizontal()?"scrollLeft":"scrollTop";this.scrollEl[n]=o}scrollToIndex(o,n="top"){if(o>=this.options.uniqueKeys.length-1){this.scrollToBottom();return}if(o<0){this.scrollToOffset(0);return}const s=this.getOffset(),f=this.getClientSize(),b=this.getSize(this.options.uniqueKeys[o]),T=this.getOffsetByRange(0,o)+this.getScrollStartOffset(),D=T+b,X=s,O=s+f;if(n==="auto"){if(T>=X&&D<=O)return;n=T<X?"top":"bottom"}if(n==="top")this.scrollToOffset(T);else if(n==="bottom"){const G=Math.max(0,D-f);this.scrollToOffset(G)}}scrollToBottom(){const o=this.getScrollSize();this.scrollToOffset(o),setTimeout(()=>{this.isReachedBottom()||this.scrollToBottom()},5)}isReachedBottom(){return this.getOffset()+this.getClientSize()+1>=this.getScrollSize()}option(o,n){const s=this.options[o];this.options[o]=n,o==="uniqueKeys"&&this.sizes.forEach((f,b)=>{n.includes(b)||this.sizes.delete(b)}),o==="scroller"&&(s&&$.utils.off(s,"scroll",this.onScroll),this.updateScrollElement(),this.addScrollEventListener())}updateRange(o){if(o){this.handleUpdate(o.start);return}let n=this.range.start;n=Math.max(n,0),this.handleUpdate(n)}updateItemSize(o,n){!n||this.sizes.get(o)===n||(this.sizes.set(o,n),this.sizeType==="INIT"?(this.sizeType="FIXED",this.fixedSize=n):this.isFixed()&&this.fixedSize!==n&&(this.sizeType="DYNAMIC",this.fixedSize=0),!this.averageSize&&this.sizeType==="DYNAMIC"&&this.sizes.size===this.options.keeps&&this.updateAverageSize())}updateAverageSize(){const o=[...this.sizes.values()].reduce((n,s)=>n+s,0);this.averageSize=Math.round(o/this.sizes.size)}addScrollEventListener(){this.options.scroller&&$.utils.on(this.options.scroller,"scroll",this.onScroll)}removeScrollEventListener(){this.options.scroller&&$.utils.off(this.options.scroller,"scroll",this.onScroll)}enableScroll(o){const n=this.options.scroller,s=o?$.utils.off:$.utils.on,f="onwheel"in document.createElement("div")?"wheel":"mousewheel";s(n,"DOMMouseScroll",this.preventDefault),s(n,f,this.preventDefault),s(n,"touchmove",this.preventDefault),s(n,"keydown",this.preventDefaultForKeyDown)}preventDefault(o){o.preventDefault()}preventDefaultForKeyDown(o){if({37:1,38:1,39:1,40:1}[o.keyCode])return this.preventDefault(o),!1}updateScrollElement(){const o=this.options.scroller;if(Bt(o)){const n=document.scrollingElement||document.documentElement||document.body;this.scrollEl=n}else this.scrollEl=o}updateOnScrollFunction(){const{debounceTime:o,throttleTime:n}=this.options;o?this.onScroll=Yt(()=>this.handleScroll(),o):n?this.onScroll=Tt(()=>this.handleScroll(),n):this.onScroll=()=>this.handleScroll()}handleScroll(){const o=this.getOffset(),n=this.getClientSize(),s=this.getScrollSize();o===this.offset?this.direction="STATIONARY":this.direction=o<this.offset?"FRONT":"BEHIND",this.offset=o;const f=this.isFront()&&o<=0,b=this.isBehind()&&n+o+1>=s;this.options.onScroll({top:f,bottom:b,offset:o,direction:this.direction}),this.isFront()?this.handleScrollFront():this.isBehind()&&this.handleScrollBehind()}handleScrollFront(){const o=this.getScrollItems();if(o>=this.range.start)return;const n=Math.max(o-this.options.buffer,0);this.checkIfUpdate(n,this.getEndByStart(n))}handleScrollBehind(){const o=this.getScrollItems();o<this.range.start+this.options.buffer||this.checkIfUpdate(o,this.getEndByStart(o))}getScrollItems(){const o=this.offset-this.getScrollStartOffset();if(o<=0)return 0;if(this.isFixed())return Math.floor(o/this.fixedSize);let n=0,s=this.options.uniqueKeys.length,f=0,b=0;for(;n<=s;){if(f=n+Math.floor((s-n)/2),b=this.getOffsetByRange(0,f),b===o)return f;b<o?n=f+1:b>o&&(s=f-1)}return n>0?--n:0}checkIfUpdate(o,n){const s=this.options.keeps;this.options.uniqueKeys.length<=s?o=0:n-o<s-1&&(o=n-s+1),this.range.start!==o&&this.handleUpdate(o)}handleUpdate(o){const n=this.range.start!==o;this.range.start=o,this.range.end=this.getEndByStart(o),this.range.front=this.getFrontOffset(),this.range.behind=this.getBehindOffset(),this.options.onUpdate({...this.range},n)}getFrontOffset(){return this.isFixed()?this.fixedSize*this.range.start:this.getOffsetByRange(0,this.range.start)}getBehindOffset(){const o=this.range.end,n=this.getLastIndex();return this.isFixed()?(n-o)*this.fixedSize:(n-o)*this.getItemSize()}getOffsetByRange(o,n){if(o>=n)return 0;let s=0;for(let f=o;f<n;f++){const b=this.sizes.get(this.options.uniqueKeys[f]);s=s+(typeof b=="number"?b:this.getItemSize())}return s}getEndByStart(o){return Math.min(o+this.options.keeps-1,this.getLastIndex())}getLastIndex(){const{uniqueKeys:o,keeps:n}=this.options;return o.length>0?o.length-1:n-1}getItemSize(){return this.isFixed()?this.fixedSize:this.options.size||this.averageSize}getScrollStartOffset(){const{wrapper:o,scroller:n}=this.options;if(n===o)return 0;let s=0;if(n&&o){const f=this.isHorizontal()?"left":"top",b=Bt(n)?$.utils.getRect(o):$.utils.getRect(o,!0,n);s=this.offset+b[f]}return s}}const It=["delay","group","handle","lockAxis","disabled","sortable","draggable","animation","autoScroll","ghostClass","ghostStyle","chosenClass","scrollSpeed","appendToBody","ghostContainer","scrollThreshold","delayOnTouchOnly","placeholderClass","dropOnAnimationEnd"],zt=["size","keeps","scroller","direction","uniqueKeys","debounceTime","throttleTime"];class Xt{constructor(o,n){this.el=o,this.options=n,this.initVirtual(),this.initSortable()}destroy(){this.virtual.removeScrollEventListener(),this.sortable.destroy()}option(o,n){this.options[o]=n,zt.includes(o)&&this.virtual.option(o,n),It.includes(o)&&this.sortable.option(o,n)}call(o,...n){if(o in this.virtual){const s=this.virtual[o];if(typeof s=="function")return s.apply(this.virtual,n);throw new Error(`Property ${String(o)} is not a function on Virtual.`)}else throw new Error(`Method ${String(o)} does not exist on Virtual.`)}initVirtual(){const o=zt.reduce((n,s)=>(n[s]=this.options[s],n),{});this.virtual=new qt({...o,buffer:this.options.buffer,wrapper:this.options.wrapper,scroller:this.options.scroller,uniqueKeys:this.options.uniqueKeys,onScroll:n=>this.onScroll(n),onUpdate:(n,s)=>this.onUpdate(n,s)})}onScroll(o){this.dispatchEvent("onScroll",o)}onUpdate(o,n){this.sortableState==="dragging"&&n&&(this.removeDraggedEl=!0),this.dispatchEvent("onUpdate",o,n)}initSortable(){const o=It.reduce((n,s)=>(n[s]=this.options[s],n),{});this.sortable=new $(this.el,{...o,emptyInsertThreshold:0,swapOnDrop:!1,removeCloneOnDrop:n=>n.from===n.to,onDrag:n=>this.onDrag(n),onDrop:n=>this.onDrop(n)})}onDrag(o){this.sortableState="dragging";const n=o.node.getAttribute("data-key"),s=this.getIndex(n);this.sortable.option("store",{key:n,index:s}),this.dispatchEvent("onDrag",{key:n,index:s,event:o})}onDrop(o){var b,T;const{key:n,index:s}=$.get(o.from).option("store"),f={key:n,event:o,changed:!1,oldIndex:s,newIndex:s};if(!(o.from===o.to&&o.node===o.target)){const D=this.getEventProperties(f,o);Object.assign(f,D)}this.dispatchEvent("onDrop",f),o.from===this.el&&this.removeDraggedEl&&((b=$.dragged)==null||b.remove()),o.from!==o.to&&((T=$.clone)==null||T.remove()),this.sortableState="",this.removeDraggedEl=!1}getEventProperties(o,n){const s=o.key,f=o.oldIndex,b=n.target.getAttribute("data-key");let T=-1,D=f;return n.from===n.to?(D=this.getIndex(s),T=this.getIndex(b),(D<T&&n.relative===-1||D>T&&n.relative===1)&&(T+=n.relative)):(n.from===this.el&&(D=this.getIndex(s)),n.to===this.el&&(D=-1,T=this.getIndex(b),n.relative===0?T=this.options.uniqueKeys.length:n.relative===1&&(T+=n.relative))),{changed:n.from!==n.to||T!==D,oldIndex:D,newIndex:T}}getIndex(o){if(o==null)return-1;const{uniqueKeys:n}=this.options;for(let s=0,f=n.length;s<f;s++)if(Et(n[s],o))return s;return-1}dispatchEvent(o,...n){if(o in this.options){const s=this.options[o];if(typeof s=="function")return s.apply(this,n)}}}const Vt={modelValue:{type:Array,default:()=>[],required:!0},dataKey:{type:String,default:"",required:!0},tableMode:{type:Boolean,default:!1},draggable:{type:String,default:'[role="item"]'},sortable:{type:Boolean,default:!0},handle:{type:[Function,String],default:void 0},group:{type:[Object,String],default:void 0},scroller:{type:[Document,HTMLElement],default:void 0},lockAxis:{type:String,default:""},direction:{type:String,default:"vertical"},keeps:{type:Number,default:30},size:{type:Number,default:void 0},debounceTime:{type:Number,default:0},throttleTime:{type:Number,default:0},animation:{type:Number,default:150},autoScroll:{type:Boolean,default:!0},scrollSpeed:{type:Object,default:()=>({x:10,y:10})},scrollThreshold:{type:Number,default:55},keepOffset:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},appendToBody:{type:Boolean,default:!1},delay:{type:Number,default:0},delayOnTouchOnly:{type:Boolean,default:!1},dropOnAnimationEnd:{type:Boolean,default:!0},rootTag:{type:String,default:"div"},wrapTag:{type:String,default:"div"},wrapClass:{type:String,default:""},wrapStyle:{type:Object,default:()=>({})},ghostClass:{type:String,default:""},ghostStyle:{type:Object,default:()=>({})},chosenClass:{type:String,default:""},placeholderClass:{type:String,default:""}},jt={dataKey:{type:[String,Number],default:void 0},horizontal:{type:Boolean,default:!1}},$t=({mounted:g,updated:o,unmounted:n})=>Dt({props:["vnode"],mounted(){g(this.$el)},onUpdated(){o(this.$el)},onUnmounted(){n(this.$el)},render(s){return s.vnode}}),Gt=Dt({props:jt,emits:["resize"],setup(g,{emit:o,slots:n}){let s=null;const f=O=>{const G=g.horizontal?"offsetWidth":"offsetHeight",B=O?O[G]:0;o("resize",B,g.dataKey)},X=$t({mounted:O=>{typeof ResizeObserver<"u"&&(s=new ResizeObserver(()=>{f(O)}),O&&s.observe(O))},updated:O=>{f(O)},unmounted:()=>{s&&(s.disconnect(),s=null)}});return()=>{var B;const{dataKey:O}=g,[G]=((B=n.default)==null?void 0:B.call(n))||[];return pt(X,{key:O,role:"item",vnode:G,"data-key":O},{default:()=>{var N;return(N=n.default)==null?void 0:N.call(n)}})}}});let Nt;const Jt=g=>Ut(g)?g.value:g,te=Dt({props:Vt,emits:["update:modelValue","top","bottom","drag","drop","rangeChange"],setup(g,{emit:o,slots:n,expose:s}){const f=mt([]),b=mt({start:0,end:g.keeps-1,front:0,behind:0}),T=mt(""),D=Ot(()=>g.direction!=="vertical"),X=mt(),O=mt();function G(h){return S.call("getSize",h)}function B(){return S.call("getOffset")}function N(){return S.call("getClientSize")}function ut(){return S.call("getScrollSize")}function K(h,p){const c=nt.indexOf(h);c>-1&&S.call("scrollToIndex",c,p)}function J(h){S.call("scrollToOffset",h)}function ht(h,p){S.call("scrollToIndex",h,p)}function vt(){J(0)}function Q(){S.call("scrollToBottom")}s({getSize:G,getOffset:B,getClientSize:N,getScrollSize:ut,scrollToTop:vt,scrollToBottom:Q,scrollToKey:K,scrollToIndex:ht,scrollToOffset:J}),Ct(()=>[g.modelValue],()=>{rt()},{deep:!0}),At(()=>{rt()}),Pt(()=>{J(S.virtual.offset),S.call("addScrollEventListener")}),Ft(()=>{S.call("removeScrollEventListener")}),Ht(()=>{R()}),Lt(()=>{S.destroy()});let nt=[],gt=0,F=0;const rt=()=>{const h=Jt(g.modelValue);if(h){if(f.value=h,w(),St(gt,h.length),F&&g.keepOffset){const p=h.length-F;p>0&&ht(p),F=0}gt=h.length}},w=()=>{nt=f.value.map(h=>Mt(h,g.dataKey)),S==null||S.option("uniqueKeys",nt)},St=(h,p)=>{if(!h&&!p||h===p)return;let c={...b.value};h>g.keeps&&p>h&&c.end===h-1&&(S!=null&&S.call("isReachedBottom"))&&c.start++,S==null||S.call("updateRange",c)};let S;const st=Ot(()=>[...zt,...It].reduce((h,p)=>(h[p]=g[p],h),{}));Ct(()=>[st],(h,p)=>{if(S)for(let c in h)h[c]!==p[c]&&S.option(c,h[c])});const L=Tt(()=>{F=f.value.length,o("top")},50),lt=Tt(()=>{o("bottom")},50),U=h=>{F=0,f.value.length&&h.top?L():h.bottom&&lt()},yt=(h,p)=>{b.value=h,p&&o("rangeChange",h)},bt=(h,p)=>{if(Et(p,T.value)||!S)return;const c=S.virtual.sizes.size;S.call("updateItemSize",p,h),c===g.keeps-1&&f.value.length>g.keeps&&S.call("updateRange",b.value)},wt=h=>{const{key:p,index:c}=h,I=f.value[c];Nt=I,T.value=p,g.sortable||(S.call("enableScroll",!1),S.option("autoScroll",!1)),o("drag",{...h,item:I})},Z=h=>{const p=Nt,{oldIndex:c,newIndex:I}=h,A=[...f.value],x=[...f.value];c===-1?x.splice(I,0,p):I===-1?x.splice(c,1):(x.splice(c,1),x.splice(I,0,p)),S.call("enableScroll",!0),S.option("autoScroll",g.autoScroll),T.value="",h.changed&&o("update:modelValue",x),o("drop",{...h,item:p,list:x,oldList:A})},R=()=>{S=new Xt(X.value,{...st.value,buffer:Math.round(g.keeps/3),wrapper:O.value,scroller:g.scroller||X.value,uniqueKeys:nt,ghostContainer:O.value,onDrag:wt,onDrop:Z,onScroll:U,onUpdate:yt})},v=h=>{if(g.tableMode){const c={padding:0,border:0,[D.value?"width":"height"]:`${h}px`};return pt("tr",{},[pt("td",{style:c})])}return null},y=()=>{const h=[],{start:p,end:c,front:I,behind:A}=b.value;h.push(v(I));for(let x=p;x<=c;x++){const Y=f.value[x];if(Y){const P=Mt(Y,g.dataKey),tt=Et(P,T.value);h.push(n.item?pt(Gt,{key:P,style:tt&&{display:"none"},dataKey:P,horizontal:D.value,onResize:bt},{default:()=>{var V;return(V=n.item)==null?void 0:V.call(n,{record:Y,index:x,dataKey:P})}}):null)}}return h.push(v(A)),h};return()=>{const{front:h,behind:p}=b.value,{tableMode:c,rootTag:I,wrapTag:A,scroller:x,wrapClass:Y,wrapStyle:P}=g,tt=D.value?"auto hidden":"hidden auto",V=D.value?`0 ${p}px 0 ${h}px`:`${h}px 0 ${p}px`,H=c?"table":I,j=c?"tbody":A;return pt(H,{ref:X,style:!x&&!c&&{overflow:tt}},{default:()=>{var et,W;return[(et=n.header)==null?void 0:et.call(n),pt(j,{ref:O,class:Y,style:{...P,padding:!c&&V}},{default:()=>y()}),(W=n.footer)==null?void 0:W.call(n)]}})}}});export{te as default};
